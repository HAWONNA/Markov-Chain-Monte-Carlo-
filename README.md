# MCMC Bayes: Yields vs. S&P 500 (2005â€“2024)

ê¸ˆë¦¬(ë¯¸êµ­ êµ­ì±„ 2Y/10Y/30Y) ë³€í™”ì™€ S&P 500ì˜ **ë°©í–¥ì„± ê´€ê³„**ë¥¼ 5ë…„ êµ¬ê°„ë³„ë¡œ ë² ì´ì§€ì•ˆ(Betaâ€“Binomial) ëª¨í˜•ìœ¼ë¡œ ì¶”ì •í•©ë‹ˆë‹¤.  
**Posterior meanê³¼ 95% Credible Interval**ì„ í‘œ/ê·¸ë¦¼ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

> **í•µì‹¬ ìš”ì•½**: 2005â€“2019ì—ëŠ” ê¸ˆë¦¬ì™€ ì£¼ê°€ê°€ **ë™í–‰**(ê¸ˆë¦¬â†‘â†’SPXâ†‘ 60â€“75%)í–ˆê³ , 2020â€“2024ì—ëŠ” ê´€ê³„ê°€ **ë¶•ê´´**ë˜ì–´ 50% ë‚´ì™¸ í˜¼ì¡°ê°€ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤.

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
.
â”œâ”€â”€ results_by_period/
â”‚   â”œâ”€â”€ 2005â€“2009/      # ê° ì¡°í•©ë³„ posterior íˆìŠ¤í† ê·¸ë¨ PNG
â”‚   â”œâ”€â”€ 2010â€“2014/
â”‚   â”œâ”€â”€ 2015â€“2019/
â”‚   â””â”€â”€ 2020â€“2024/
â”œâ”€â”€ bayes_results_by_period.csv  # 5ë…„Ã—(ë§Œê¸°Ã—ì¡°í•©) ê²°ê³¼ í…Œì´ë¸”
â”œâ”€â”€ main.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ .gitignore (ê¶Œì¥)
```

ê¶Œì¥ `.gitignore`:
```
# Python
__pycache__/
*.pyc
*.pyo
*.pyd
*.egg-info/
.venv/
venv/
.env

# OS
.DS_Store

# Plots / caches
results_by_period/**/*.png
```

---

## ğŸ”§ì„¤ì¹˜

```bash
# 1) ê°€ìƒí™˜ê²½ (ì„ íƒ)
python -m venv .venv
# Windows
.venv\Scripts\activate
# macOS/Linux
source .venv/bin/activate

# 2) í•„ìˆ˜ íŒ¨í‚¤ì§€
pip install -r requirements.txt
# (pandas, numpy, matplotlib, yfinance, pandas_datareader, scipy ë“±)
```

> ì°¸ê³ : ìµœì‹  yfinanceëŠ” `auto_adjust=True` ê¸°ë³¸ê°’ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

---

## â–¶ì‹¤í–‰

```bash
python main.py
```

- ê²°ê³¼ CSV: `bayes_results_by_period.csv`  
- ê° êµ¬ê°„ í´ë”ì— **12ê°œ ì¡°í•©(ë§Œê¸° 3 Ã— ê¸ˆë¦¬â†‘/â†“ 2 Ã— SPXâ†‘/â†“ 2)** ì˜ Posterior íˆìŠ¤í† ê·¸ë¨ PNG ì €ì¥

---

## ë°©ë²•ë¡  (ìˆ˜ì‹)

### ë³€ìˆ˜ ì •ì˜
- ì£¼ê°€ ë¡œê·¸ìˆ˜ìµë¥ :  
  $$ r_t^{\mathrm{SPX}} = \ln\!\left(\frac{P_t}{P_{t-1}}\right) $$
- ê¸ˆë¦¬ ë³€í™”(ë§Œê¸° \(k\in\{2Y,10Y,30Y\}\)):  
  $$ \Delta y_t^{(k)} = y_t^{(k)} - y_{t-1}^{(k)} $$

ì¼€ì´ìŠ¤:
- ê¸ˆë¦¬ ìƒìŠ¹ì¼: \( \Delta y_t^{(k)} > 0 \), í•˜ë½ì¼: \( \Delta y_t^{(k)} < 0 \)  
- SPX ìƒìŠ¹ì¼: \( r_t^{\mathrm{SPX}} > 0 \), í•˜ë½ì¼: \( r_t^{\mathrm{SPX}} < 0 \)

### ë² íƒ€-ë² ë¥´ëˆ„ì´ ëª¨í˜•
ê¸ˆë¦¬ **ìƒìŠ¹/í•˜ë½** ì¡°ê±´ì—ì„œ SPX **ìƒìŠ¹** ì—¬ë¶€ë¥¼ ì„±ê³µ(1)/ì‹¤íŒ¨(0) ë² ë¥´ëˆ„ì´ ì‹œí–‰ìœ¼ë¡œ ëª¨ë¸ë§:
- ì„±ê³µ í•© \(S\), ì‹œí–‰ìˆ˜ \(N\)
- ìš°ë„: \( L(\theta\mid x) = \theta^{S}(1-\theta)^{N-S} \)

ì‚¬ì „ë¶„í¬(ê¸°ë³¸): \( \theta \sim \mathrm{Beta}(\alpha_0,\beta_0) \) (ê¸°ë³¸ê°’ \(\mathrm{Beta}(1,1)\))  
ì‚¬í›„ë¶„í¬: \( \theta\mid \text{data} \sim \mathrm{Beta}(\alpha_0+S,\ \beta_0+N-S) \)

ì‚¬í›„í‰ê· /ë¶„ì‚°:
$$
\mathbb{E}[\theta\mid \text{data}] = \frac{\alpha_0+S}{\alpha_0+\beta_0+N}, \qquad
\mathrm{Var}[\theta\mid \text{data}] = \frac{(\alpha_0+S)(\beta_0+N-S)}{(\alpha_0+\beta_0+N)^2(\alpha_0+\beta_0+N+1)}.
$$

### Empirical Bayes (ì„ íƒ)
í‘œë³¸ë¹„ìœ¨ \( \hat p=S/N \), í‘œë³¸ë¶„ì‚° \( \hat v=\hat p(1-\hat p)/N \) ìœ¼ë¡œ ëª¨ë©˜íŠ¸ ì¼ì¹˜:
$$
\alpha = \hat p\!\left(\frac{\hat p(1-\hat p)}{\hat v}-1\right),\quad
\beta = (1-\hat p)\!\left(\frac{\hat p(1-\hat p)}{\hat v}-1\right).
$$

### ì‚¬í›„ ìƒ˜í”Œë§
ì‚¬í›„ê°€ Betaë¡œ ë‹«í˜€ ìˆìœ¼ë¯€ë¡œ MCMC ëŒ€ì‹  ë…ë¦½í‘œë³¸:
- \( \theta^{(i)} \sim \mathrm{Beta}(\alpha_0+S,\beta_0+N-S) \), \(i=1,\dots,M\) (ê¸°ë³¸ \(M=200{,}000\))
- 95% CI: ìƒ˜í”Œ ë¶„ìœ„ìˆ˜ 2.5%, 97.5%

---

## 5ë…„ êµ¬ê°„ë³„ ê²°ê³¼ (Posterior mean \[95% CI\])

### 2005â€“2009
| Rate | ê¸ˆë¦¬â†‘â†’SPXâ†‘ | ê¸ˆë¦¬â†‘â†’SPXâ†“ | ê¸ˆë¦¬â†“â†’SPXâ†‘ | ê¸ˆë¦¬â†“â†’SPXâ†“ |
|---|---|---|---|---|
| 2Y | **65.5% [62.8â€“68.2]** | 34.5% [31.8â€“37.2] | 43.3% [40.3â€“46.3] | **56.5% [53.5â€“59.5]** |
| 10Y | **62.5% [59.6â€“65.2]** | 37.5% [34.8â€“40.3] | 46.4% [43.5â€“49.2] | **53.6% [50.8â€“56.5]** |
| 30Y | **58.6% [55.7â€“61.4]** | 41.3% [38.4â€“44.2] | 48.9% [46.0â€“51.8] | **51.1% [48.2â€“54.0]** |

### 2010â€“2014
| Rate | ê¸ˆë¦¬â†‘â†’SPXâ†‘ | ê¸ˆë¦¬â†‘â†’SPXâ†“ | ê¸ˆë¦¬â†“â†’SPXâ†‘ | ê¸ˆë¦¬â†“â†’SPXâ†“ |
|---|---|---|---|---|
| 2Y | **65.8% [62.6â€“68.9]** | 34.2% [31.0â€“37.4] | 43.5% [40.3â€“46.8] | **56.5% [53.2â€“59.7]** |
| 10Y | **74.4% [71.8â€“77.0]** | 25.6% [23.1â€“28.2] | 38.0% [35.3â€“40.7] | **62.0% [59.3â€“64.7]** |
| 30Y | **75.0% [72.4â€“77.5]** | 25.0% [22.5â€“27.6] | 38.8% [36.1â€“41.6] | **61.2% [58.4â€“63.9]** |

### 2015â€“2019
| Rate | ê¸ˆë¦¬â†‘â†’SPXâ†‘ | ê¸ˆë¦¬â†‘â†’SPXâ†“ | ê¸ˆë¦¬â†“â†’SPXâ†‘ | ê¸ˆë¦¬â†“â†’SPXâ†“ |
|---|---|---|---|---|
| 2Y | **65.7% [62.8â€“68.5]** | 34.3% [31.5â€“37.2] | 39.2% [36.2â€“42.4] | **60.5% [57.4â€“63.6]** |
| 10Y | **67.2% [64.3â€“69.9]** | 32.8% [30.1â€“35.7] | 39.3% [36.5â€“42.1] | **60.7% [57.8â€“63.5]** |
| 30Y | **66.9% [64.0â€“69.7]** | 33.1% [30.3â€“35.9] | 42.2% [39.4â€“45.1] | **57.8% [54.9â€“60.6]** |

### 2020â€“2024
| Rate | ê¸ˆë¦¬â†‘â†’SPXâ†‘ | ê¸ˆë¦¬â†‘â†’SPXâ†“ | ê¸ˆë¦¬â†“â†’SPXâ†‘ | ê¸ˆë¦¬â†“â†’SPXâ†“ |
|---|---|---|---|---|
| 2Y | 52.5% [49.5â€“55.5] | 47.5% [44.5â€“50.5] | 52.5% [49.3â€“55.6] | 47.5% [44.3â€“50.7] |
| 10Y | 54.3% [51.4â€“57.1] | 45.7% [42.9â€“48.6] | 54.5% [51.6â€“57.4] | 45.5% [42.6â€“48.4] |
| 30Y | 55.1% [52.3â€“57.9] | 44.9% [42.1â€“47.7] | 53.3% [50.4â€“56.1] | 46.7% [43.8â€“49.6] |

---

## âš™ï¸ ì„¤ì • ë³€ê²½ íŒ

`main.py` ìƒë‹¨ì˜ ê¸°ê°„/êµ¬ê°„/ìƒ˜í”Œ ìˆ˜ë¥¼ ì¡°ì •í•˜ì„¸ìš”.
```python
start = datetime.datetime(2005, 1, 1)
end   = datetime.datetime(2025, 1, 1)

periods = [
    ("2005-01-01", "2009-12-31"),
    ("2010-01-01", "2014-12-31"),
    ("2015-01-01", "2019-12-31"),
    ("2020-01-01", "2024-12-31"),
]

SAMPLES = 200_000
```

---

## ë°ì´í„° ì¶œì²˜
- **S&P 500**: Yahoo Finance (`^GSPC`, `yfinance`)  
- **ê¸ˆë¦¬**: FRED â€“ DGS2, DGS10, DGS30 (`pandas_datareader`)

---

## ë””ìŠ¤í´ë ˆì´ë¨¸
ì—°êµ¬/êµìœ¡ ëª©ì ì˜ ì½”ë“œì…ë‹ˆë‹¤. íˆ¬ì ìë¬¸ì´ ì•„ë‹ˆë©°, ê³¼ê±° ì„±ê³¼ëŠ” ë¯¸ë˜ë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

